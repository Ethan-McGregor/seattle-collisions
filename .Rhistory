# slider to change number of variables
sliderInput("integer", "Number of Variables", min=2, max=10, value=500)
),
mainPanel(
leafletoutput("heat")
)
)
))
shinyUI(fluidPage(
titlePanel("Exploring Cereal"),
sidebarLayout( position = "right",
sidebarPanel(
# slider to change number of variables
sliderInput("integer", "Number of Variables", min=2, max=10, value=500)
),
mainPanel(
leafletOutput("heat")
)
)
))
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
render()
render <- function(){
output$heat <- renderLeaflet({
leaflet(data = sliderValues()) %>%
addTiles() %>%
addCircleMarkers(~lng, ~lat)   })
}
render()
render()
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
runApp('C:/Users/ermmc/Desktop/seattle-collisions')
noNa <- getData()
noNa <- getData()
source('scripts/map.R')
source('script/map.R')
s
source('scripts/map.R')
source('scripts/map.R')
noNa <- getData()
source('../scripts/map.R')
setwd("C:/Users/ermmc/Desktop/seattle-collisions")
source('scripts/map.R')
noNa <- getData()
runApp()
runApp()
runApp()
runApp()
View(noNa)
runApp()
View(noNa)
runApp()
runApp()
runApp()
shiny::runApp()
install.packages('leaflet')
runApp()
View(noNa)
View(noNa)
collisons <- read.csv('./data/SDOT_Collisions.csv')
# remove rows with missing data
collisions = collisons[complete.cases(collisons),]
rm(list = ls())
collisions <- read.csv('./data/SDOT_Collisions.csv')
# remove rows with missing data
collisions = collisons[complete.cases(collisons),]
# remove rows with missing data
collisions = collisons[complete.cases(collisons),]
collisions <- collisons[complete.cases(collisons),]
collisions <- collisions[complete.cases(collisions),]
library('plotly')
collisions <- mutate(collisions, year = format.Date(as.Date(collisions$INCDATE, "%B %d, %Y"), "%Y"))
View(collisions)
View(collisions)
collisions <- mutate(collisions, date = substr(collisions$INCDATE, 1, 10))
collisions <- mutate(collisions, year = format.Date(as.Date(collisions$date, "%B %d, %Y"), "%Y"))
collisions <- read.csv('./data/SDOT_Collisions.csv')
# remove rows with missing data
collisions <- collisions[complete.cases(collisions),]
collisions <- mutate(collisions, date = substr(collisions$INCDATE, 1, 10))
collisions <- mutate(collisions, year = format.Date(as.Date(collisions$date, "%B %d, %Y"), "%Y"))
collisions <- mutate(collisions, year = as.Date(collisions$date, "%B %d, %Y"))
collisions <- read.csv('./data/SDOT_Collisions.csv', stringsAsFactors = F)
collisions <- collisions[complete.cases(collisions),]
collisions <- mutate(collisions, year = format.Date(as.Date(collisions$INCDATE, "%B %d, %Y"), "%Y"))
collisions <- mutate(collisions, date = substr(collisions$INCDATE, 1, 10))
collisions <- mutate(collisions, year = format.Date(as.Date(collisions$date, "%B %d, %Y"), "%Y"))
collisions <- read.csv('./data/SDOT_Collisions.csv', stringsAsFactors = F)
collisions <- collisions[complete.cases(collisions),]
collisions <- collisions[complete.cases(collisions),]
collisions <- mutate(collisions, date = substr(collisions$INCDATE, 1, 10))
collisions <- mutate(collisions, y = as.Date(collisions$date, "%B %d, %Y"))
collisions <- mutate(collisions, year = format.Date(as.Date(collisions$INCDATE, "%B/%d/%Y"), "%Y"))
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10))
collisions <- read.csv('./data/SDOT_Collisions.csv', stringsAsFactors = F)
# remove rows with missing data
collisions <- collisions[complete.cases(collisions),]
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10))
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10)) %>% group_by(year, SEVERITYDESC)
colnames(collisions)
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10)) %>% group_by(SEVERITYDESC)
collisions <- group_by(SEVERITYDESC)
collisions <- group_by(collisions, SEVERITYDESC)
#get year from datetime
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10)) %>%
group_by(year, SEVERITYDESC) %>%
summarise(count = n())
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10)) %>%
summarise(count = n())
collisions <- read.csv('./data/SDOT_Collisions.csv', stringsAsFactors = F)
# remove rows with missing data
collisions <- collisions[complete.cases(collisions),]
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10))
collisions <- group_by(year, SEVERITYDESC)
collisions <- group_by(collisions, year, SEVERITYDESC)
View(collisions)
count <- summarise(collisions, count = n())
View(count)
View(count)
collisions <- read.csv('./data/SDOT_Collisions.csv', stringsAsFactors = F)
collisions <- mutate(collisions, year = substr(collisions$INCDATE, 7, 10))
collisions <- group_by(collisions, year, SEVERITYDESC)
count <- summarise(collisions, count = n())
count <- count[4:68,]
count.wide <- spread(count, SEVERITYDESC, count)
library('tidyr')
count.wide <- spread(count, SEVERITYDESC, count)
View(count.wide)
View(count.wide)
colnames(count.wide)
tidy.name.vector <- make.names(colnames(count.wide), unique=TRUE)
colnames(count.wide) <- tidy.name.vector
colnames(count.wide)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Fatality.Collision,
type = "bar",
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "purple")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "blue")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "green")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack",
margin = list(t = 100, b = 260))
View(chart)
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Fatality.Collision,
type = "bar",
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "purple")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "blue")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "green")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = "purple")) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = "green")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "green")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "blue")) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "green")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = "purple")) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = "green")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "red")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "blue")) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "black")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
library('RColorBrewer')
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = brewer.pal(5, "Paired"))) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions")) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = brewer.pal(5, "Paired"))) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = brewer.pal(5, "Paired"))) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = brewer.pal(5, "Paired"))) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = brewer.pal(5, "Paired"))) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = brewer.pal(5, "Paired"))) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = brewer.pal(1, "Paired"))) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = brewer.pal(1, "Paired"))) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = brewer.pal(1, "Paired"))) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = brewer.pal(1, "Paired"))) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = brewer.pal(1, "Paired"))) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = brewer.pal(12, "Paired"))) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = brewer.pal(12, "Paired"))) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = brewer.pal(12, "Paired"))) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = brewer.pal(12, "Paired"))) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = brewer.pal(12, "Paired"))) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = "#ffe5e5")) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = "#ff9999")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "#b20000")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "#660000")) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "#190000")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
tidy.name.vector <- make.names(colnames(count.wide), unique=TRUE)
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = "#ffe5e5")) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = "#ff7f7f")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "#b20000")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "#660000")) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "#000000")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = "#ffe5e5")) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = "#ff7f7f")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "#cc0000")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "#7f0000")) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "#000000")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
chart <- plot_ly (count.wide,
x = ~year,
y = ~Unknown,
type = "bar",
name = "Unknown",
hoverinfo = "text",
text = ~paste(Unknown, "Unknown"),
marker = list(color = "#ffb2b2")) %>%
add_trace(y = ~Property.Damage.Only.Collision,
name = "Property Damage Only Collisions",
hoverinfo = "text",
text = ~paste(Property.Damage.Only.Collision, "Property Damage Only Collisions"),
marker = list(color = "#ff4c4c")) %>%
add_trace(y = ~Injury.Collision,
name = "Injury Collisions",
hoverinfo = "text",
text = ~paste(Injury.Collision, "Injury Collisions"),
marker = list(color = "#cc0000")) %>%
add_trace(y = ~Serious.Injury.Collision,
name = "Serious Injury Collisions",
hoverinfo = "text",
text = ~paste(Serious.Injury.Collision, "Serious Injury Collisions"),
marker = list(color = "#7f0000")) %>%
add_trace(y = ~Fatality.Collision,
name = "Fatality Collisions",
hoverinfo = "text",
text = ~paste(Fatality.Collision, "Fatality Collisions"),
marker = list(color = "#000000")) %>%
layout(title = "Seattle Collisions 2004 - 2016",
xaxis = list(title = "Year"),
yaxis = list(title = "# of Collisions"),
barmode = "stack")
print(chart)
